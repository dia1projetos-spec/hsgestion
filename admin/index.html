<!DOCTYPE html>
<html lang="es-AR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HS GestiÃ³n â€“ Admin</title>
  <meta name="robots" content="noindex,nofollow" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="stylesheet" href="css/admin.css?v=2.0.0" />
</head>
<body>

<!-- LOGIN SCREEN -->
<div id="loginScreen" style="display:flex;align-items:center;justify-content:center;min-height:100vh;">
  <div style="text-align:center;">
    <img src="../images/logo.png" style="height:48px;margin-bottom:20px;display:block;margin-left:auto;margin-right:auto;" />
    <div style="width:34px;height:34px;border:3px solid #21262d;border-top-color:#1f6feb;border-radius:50%;animation:sp 1s linear infinite;margin:0 auto 14px;"></div>
    <p style="color:#484f58;font-size:.83rem;">Verificando acceso...</p>
    <p style="margin-top:12px;"><a href="../index.html" style="color:#58a6ff;font-size:.78rem;">â† Ir al login</a></p>
    <style>@keyframes sp{to{transform:rotate(360deg)}}</style>
  </div>
</div>

<!-- ADMIN APP -->
<div id="adminApp" style="display:none;">
  <div id="wrapper">

    <!-- SIDEBAR OVERLAY -->
    <div class="sb-overlay" id="sbOverlay"></div>

    <!-- SIDEBAR -->
    <aside id="sidebar">
      <div class="sb-logo">
        <img src="../images/logo.png" alt="HS" />
        <span>HS GestiÃ³n</span>
      </div>
      <nav class="sb-nav">
        <span class="sb-label">Principal</span>
        <button class="sb-item active" data-pg="dashboard"><span class="ic">ğŸ“Š</span> Dashboard</button>
        <button class="sb-item" data-pg="usuarios"><span class="ic">ğŸ‘¥</span> Usuarios <span class="sb-pill" id="userPill">0</span></button>
        <span class="sb-label">ComunicaciÃ³n</span>
        <button class="sb-item" data-pg="mensajes"><span class="ic">ğŸ’¬</span> Mensajes</button>
        <button class="sb-item" data-pg="packs"><span class="ic">ğŸ“¦</span> Packs</button>
        <button class="sb-item" data-pg="proyectos"><span class="ic">ğŸ—‚ï¸</span> Proyectos</button>
        <span class="sb-label">Cuenta</span>
        <button class="sb-item danger" id="logoutBtn"><span class="ic">ğŸšª</span> Cerrar SesiÃ³n</button>
      </nav>
      <div class="sb-footer">
        <div class="sb-user">
          <div class="sb-avatar">A</div>
          <div class="sb-user-info">
            <small>Administrador</small>
            <span id="adminEmail">â€”</span>
          </div>
        </div>
      </div>
    </aside>

    <!-- MAIN -->
    <div id="mainWrap">
      <div id="topbar">
        <div style="display:flex;align-items:center;">
          <button id="menuToggle">â˜°</button>
          <span id="topbarTitle">Dashboard</span>
        </div>
        <button class="btn btn-gray btn-sm" id="btnRefresh">ğŸ”„ Actualizar</button>
      </div>

      <div id="content">

        <!-- DASHBOARD -->
        <div class="page active" id="pg-dashboard">
          <div class="stats">
            <div class="stat"><div class="stat-ic">ğŸ‘¥</div><div class="stat-lbl">Usuarios</div><div class="stat-val" id="stUsers">0</div></div>
            <div class="stat"><div class="stat-ic">âœ…</div><div class="stat-lbl">Pagados</div><div class="stat-val" id="stPaid">0</div></div>
            <div class="stat"><div class="stat-ic">â³</div><div class="stat-lbl">Pendientes</div><div class="stat-val" id="stOpen">0</div></div>
            <div class="stat"><div class="stat-ic">ğŸ“¦</div><div class="stat-lbl">Packs</div><div class="stat-val" id="stPacks">0</div></div>
          </div>
          <div class="dash-row">

            <!-- Coluna esquerda: Clock + AÃ§Ãµes -->
            <div style="display:flex;flex-direction:column;gap:14px;">
              <!-- RelÃ³gio -->
              <div class="box">
                <div style="font-size:.6rem;letter-spacing:2px;text-transform:uppercase;color:#484f58;margin-bottom:10px;font-family:monospace;">âŸ¡ Hora actual</div>
                <div id="adminClock" style="font-family:'Courier New',monospace;font-size:2.2rem;font-weight:300;color:#f0f6fc;letter-spacing:4px;line-height:1;margin-bottom:4px;">00:00:00</div>
                <div id="adminDate" style="font-size:.72rem;color:#484f58;font-family:monospace;letter-spacing:.5px;text-transform:uppercase;"></div>
              </div>
              <!-- AÃ§Ãµes -->
              <div class="box">
                <h3>âš¡ Acciones RÃ¡pidas</h3>
                <div style="display:flex;flex-direction:column;gap:8px;">
                  <button class="btn btn-blue" id="dBtnUser">â• Crear Nuevo Usuario</button>
                  <button class="btn btn-gray" id="dBtnMsg">ğŸ“¨ Enviar Mensaje</button>
                  <button class="btn btn-gray" id="dBtnPacks">ğŸ“¦ Ver Packs</button>
                </div>
              </div>
            </div>

            <!-- Coluna direita: Ãšltimos usuÃ¡rios + Agenda -->
            <div style="display:flex;flex-direction:column;gap:14px;">
              <div class="box">
                <h3>ğŸ“‹ Ãšltimos Usuarios</h3>
                <div id="dashRecent"><p style="color:#484f58;font-size:.83rem;">Cargando...</p></div>
              </div>
              <!-- Agenda Admin -->
              <div class="box">
                <h3>ğŸ“… Mi Agenda</h3>
                <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;">
                  <div style="display:flex;align-items:center;gap:8px;">
                    <button id="adAgPrev" style="background:#0d1117;border:1px solid #21262d;color:#8b949e;width:24px;height:24px;border-radius:5px;cursor:pointer;font-size:.75rem;">â€¹</button>
                    <span id="adAgMonth" style="font-size:.75rem;font-weight:700;color:#f0f6fc;font-family:monospace;letter-spacing:1px;text-transform:uppercase;"></span>
                    <button id="adAgNext" style="background:#0d1117;border:1px solid #21262d;color:#8b949e;width:24px;height:24px;border-radius:5px;cursor:pointer;font-size:.75rem;">â€º</button>
                  </div>
                </div>
                <div id="adAgGrid" style="display:grid;grid-template-columns:repeat(7,1fr);gap:2px;"></div>
                <div id="adAgEvents" style="margin-top:8px;max-height:80px;overflow-y:auto;"></div>
                <div style="display:flex;gap:6px;margin-top:8px;">
                  <input type="text" id="adAgInput" placeholder="Agregar evento..."
                    style="flex:1;background:#0d1117;border:1px solid #30363d;border-radius:6px;padding:6px 10px;color:#c9d1d9;font-size:.75rem;outline:none;font-family:inherit;" />
                  <button id="adAgAdd" class="btn btn-blue btn-sm">+ Add</button>
                </div>
              </div>
            </div>

          </div>
        </div>

        <!-- USUARIOS -->
        <div class="page" id="pg-usuarios">
          <div class="sec-header">
            <h2>GestiÃ³n de Usuarios</h2>
            <button class="btn btn-blue" id="btnNewUser">â• Crear Usuario</button>
          </div>
          <div class="tbl-wrap">
            <div class="tbl-scroll">
              <table>
                <thead>
                  <tr>
                    <th>Usuario</th>
                    <th>Servicio</th>
                    <th>Valor</th>
                    <th>Pago</th>
                    <th>Fecha</th>
                    <th>PÃ¡gina</th>
                    <th>Acciones</th>
                  </tr>
                </thead>
                <tbody id="usersBody"></tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- MENSAJES -->
        <div class="page" id="pg-mensajes">
          <div class="sec-header">
            <h2>Mensajes</h2>
            <button class="btn btn-blue" id="btnNewMsg">ğŸ“¨ Nuevo Mensaje</button>
          </div>
          <!-- Tabs -->
          <div style="display:flex;gap:8px;margin-bottom:16px;">
            <button class="btn btn-blue btn-sm" id="tabAdmin" onclick="switchMsgTab('admin')">ğŸ“¤ Enviados por vos</button>
            <button class="btn btn-gray btn-sm" id="tabClient" onclick="switchMsgTab('client')">ğŸ“¥ De clientes <span id="clientMsgCount" style="background:#da3633;color:#fff;border-radius:20px;padding:1px 6px;font-size:.65rem;margin-left:4px;display:none;">0</span></button>
          </div>
          <div id="msgListAdmin" class="msg-list">
            <div class="empty"><span class="empty-ic">ğŸ’¬</span><p>Sin mensajes aÃºn</p></div>
          </div>
          <div id="msgListClient" class="msg-list" style="display:none;">
            <div class="empty"><span class="empty-ic">ğŸ“¥</span><p>Sin mensajes de clientes aÃºn</p></div>
          </div>
        </div>

        <!-- PACKS -->
        <div class="page" id="pg-packs">
          <div class="sec-header">
            <h2>Packs de Contenido</h2>
            <button class="btn btn-blue" id="btnNewPack">â• Nuevo Pack</button>
          </div>
          <div class="packs-grid" id="packsGrid">
            <div class="empty" style="grid-column:1/-1"><span class="empty-ic">ğŸ“¦</span><p>Sin packs aÃºn</p></div>
          </div>
        </div>

        <!-- PROYECTOS -->
        <div class="page" id="pg-proyectos">
          <div class="sec-header">
            <h2>Proyectos / Portafolio</h2>
            <button class="btn btn-blue" id="btnNewProject">â• Nuevo Proyecto</button>
          </div>
          <div class="info-box">
            Los proyectos aparecen automÃ¡ticamente en las pÃ¡ginas de servicio segÃºn la categorÃ­a elegida.
            <br/>ğŸŒ <a href="../servicos/sites.html" target="_blank" style="color:#58a6ff;">Ver pÃ¡gina Sitios Web</a>
            &nbsp;Â·&nbsp; ğŸ“± <a href="../servicos/redes.html" target="_blank" style="color:#f87171;">Ver pÃ¡gina Redes</a>
            &nbsp;Â·&nbsp; âœ‰ï¸ <a href="../servicos/convites.html" target="_blank" style="color:#34d399;">Ver pÃ¡gina Convites</a>
          </div>
          <!-- Filtros -->
          <div style="display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap;">
            <button class="btn btn-blue btn-sm"  onclick="filterProjects('all')"     id="pf-all">Todos</button>
            <button class="btn btn-gray btn-sm"  onclick="filterProjects('site')"    id="pf-site">ğŸŒ Sitios Web</button>
            <button class="btn btn-gray btn-sm"  onclick="filterProjects('redes')"   id="pf-redes">ğŸ“± Redes</button>
            <button class="btn btn-gray btn-sm"  onclick="filterProjects('convite')" id="pf-convite">âœ‰ï¸ Convites</button>
          </div>
          <div class="packs-grid" id="projectsAdminGrid">
            <div class="empty" style="grid-column:1/-1"><span class="empty-ic">ğŸ—‚ï¸</span><p>Sin proyectos aÃºn. HacÃ© clic en "Nuevo Proyecto".</p></div>
          </div>
        </div>

      </div><!-- /content -->
    </div><!-- /mainWrap -->
  </div><!-- /wrapper -->
</div><!-- /adminApp -->


<!-- â•â•â• MODALES â•â•â• -->

<!-- Modal Usuario -->
<div class="modal-bg" id="mUser">
  <div class="modal modal-lg">
    <div class="modal-hd">
      <h3 id="mUserTitle">Crear Usuario</h3>
      <button class="modal-x" data-close>âœ•</button>
    </div>
    <form id="userForm" autocomplete="off">
      <div class="fr">
        <div class="fg"><label>Nombre *</label><input type="text" id="uName" placeholder="Ej: MarÃ­a GarcÃ­a" required /></div>
        <div class="fg"><label>Email *</label><input type="email" id="uEmail" placeholder="cliente@email.com" required /></div>
      </div>
      <div class="fr">
        <div class="fg">
          <label>ContraseÃ±a (referencia)</label>
          <input type="text" id="uPassword" placeholder="Para Firebase Auth" />
          <p class="hint">GuardÃ¡ este dato para crear la cuenta en Firebase Console</p>
        </div>
        <div class="fg"><label>Servicio contratado</label><input type="text" id="uService" placeholder="Ej: DiseÃ±o Web + Redes" /></div>
      </div>
      <div class="fr">
        <div class="fg"><label>Valor del servicio ($)</label><input type="number" id="uValue" placeholder="Ej: 150000" min="0" /></div>
        <div class="fg">
          <label>Estado de pago</label>
          <div class="radio-row">
            <label class="radio-opt"><input type="radio" name="pay" value="paid" /> âœ… Pagado</label>
            <label class="radio-opt"><input type="radio" name="pay" value="open" checked /> â³ Pendiente</label>
          </div>
        </div>
      </div>
      <div class="fg">
        <label>Archivo de logo</label>
        <input type="text" id="uLogo" placeholder="Ej: maria.png" autocomplete="off" />
        <p class="hint">ColocÃ¡ el archivo en <code>images/usuarios/</code> y escribÃ­ solo el nombre.</p>
        <img id="logoPreview" src="" alt="" style="display:none;width:56px;height:56px;object-fit:cover;border-radius:8px;border:1px solid #30363d;margin-top:8px;" />
      </div>
      <div class="firebase-tip" id="fbTip">
        âš ï¸ <strong>RecordÃ¡ crear la cuenta en Firebase Auth:</strong><br/>
        <a href="https://console.firebase.google.com" target="_blank">console.firebase.google.com</a>
        â†’ Authentication â†’ Users â†’ Agregar usuario<br/>
        UsÃ¡ el mismo email y la contraseÃ±a de arriba.
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:14px;">
        <button type="button" class="btn btn-gray" data-close>Cancelar</button>
        <button type="submit" class="btn btn-blue" id="saveUserBtn">ğŸ’¾ Guardar</button>
      </div>
    </form>
  </div>
</div>

<!-- Modal Mensaje -->
<div class="modal-bg" id="mMsg">
  <div class="modal">
    <div class="modal-hd"><h3>ğŸ“¨ Nuevo Mensaje</h3><button class="modal-x" data-close>âœ•</button></div>
    <form id="msgForm">
      <div class="fg">
        <label>Para</label>
        <select id="msgTo"><option value="">ğŸ“¢ Todos los usuarios</option></select>
      </div>
      <div class="fg">
        <label>Mensaje *</label>
        <textarea id="msgTxt" placeholder="EscribÃ­ el mensaje acÃ¡..." required></textarea>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end;">
        <button type="button" class="btn btn-gray" data-close>Cancelar</button>
        <button type="submit" class="btn btn-blue" id="saveMsgBtn">ğŸ“¨ Enviar</button>
      </div>
    </form>
  </div>
</div>

<!-- Modal Nuevo Pack -->
<div class="modal-bg" id="mPack">
  <div class="modal modal-lg">
    <div class="modal-hd"><h3 id="mPackTitle">ğŸ“¦ Nuevo Pack</h3><button class="modal-x" data-close>âœ•</button></div>
    <form id="packForm" autocomplete="off">
      <div class="fr">
        <div class="fg">
          <label>TÃ­tulo del pack *</label>
          <input type="text" id="pTitle" placeholder="Ej: Pack Redes Enero" required />
        </div>
        <div class="fg">
          <label>Asignar a</label>
          <select id="packTo"><option value="">â€” Todos / Elegir despuÃ©s â€”</option></select>
        </div>
      </div>
      <div class="fg">
        <label>DescripciÃ³n</label>
        <input type="text" id="pDesc" placeholder="Ej: 10 imÃ¡genes para redes sociales" />
      </div>
      <div class="fg">
        <label>Archivos (imÃ¡genes o videos) *</label>
        <input type="file" id="pFiles" multiple accept="image/*,video/*" required />
        <p class="hint">PodÃ©s subir mÃºltiples archivos a la vez. ImÃ¡genes y videos.</p>
      </div>
      <!-- Progress -->
      <div id="uploadProgress" style="display:none;margin-top:8px;">
        <div style="background:#0d1117;border-radius:6px;height:8px;overflow:hidden;margin-bottom:6px;">
          <div id="progressBar" style="height:100%;background:linear-gradient(90deg,#1f6feb,#0ea5e9);width:0%;transition:width .3s;border-radius:6px;"></div>
        </div>
        <p id="progressTxt" style="font-size:.75rem;color:#484f58;">Subiendo archivos...</p>
      </div>
      <!-- Preview -->
      <div id="filePreview" style="display:none;margin-top:10px;">
        <p style="font-size:.72rem;color:#484f58;margin-bottom:6px;text-transform:uppercase;letter-spacing:.5px;">Vista previa</p>
        <div id="previewGrid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(80px,1fr));gap:8px;"></div>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:14px;">
        <button type="button" class="btn btn-gray" data-close>Cancelar</button>
        <button type="submit" class="btn btn-blue" id="savePackBtn">â˜ï¸ Subir y Guardar</button>
      </div>
    </form>
  </div>
</div>

<!-- Modal Asignar Pack a usuario -->
<div class="modal-bg" id="mAssign">
  <div class="modal">
    <div class="modal-hd"><h3>ğŸ‘¤ Asignar Pack</h3><button class="modal-x" data-close>âœ•</button></div>
    <form id="assignForm">
      <input type="hidden" id="assignPackId" />
      <div class="fg">
        <label>Asignar a</label>
        <select id="assignTo" required><option value="">â€” Seleccionar usuario â€”</option></select>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px;">
        <button type="button" class="btn btn-gray" data-close>Cancelar</button>
        <button type="submit" class="btn btn-green">âœ… Asignar</button>
      </div>
    </form>
  </div>
</div>

<!-- Modal Confirmar -->
<div class="modal-bg" id="mConfirm">
  <div class="modal confirm-box">
    <span class="ic">âš ï¸</span>
    <h3 style="font-family:'Syne',sans-serif;font-size:.98rem;font-weight:700;color:#f0f6fc;margin-bottom:8px;">Â¿ConfirmÃ¡s?</h3>
    <p id="confirmTxt"></p>
    <div class="btn-row">
      <button class="btn btn-gray" id="confirmNo">Cancelar</button>
      <button class="btn btn-red"  id="confirmSi">SÃ­, confirmar</button>
    </div>
  </div>
</div>

<!-- Modal Nuevo Proyecto -->
<div class="modal-bg" id="mProject">
  <div class="modal modal-lg">
    <div class="modal-hd"><h3 id="mProjectTitle">â• Nuevo Proyecto</h3><button class="modal-x" data-close>âœ•</button></div>
    <form id="projectForm" autocomplete="off">
      <div class="fr">
        <div class="fg">
          <label>TÃ­tulo del proyecto *</label>
          <input type="text" id="prjTitle" placeholder="Ej: Sitio para Restaurante Bella" required/>
        </div>
        <div class="fg">
          <label>CategorÃ­a *</label>
          <select id="prjCategory" required>
            <option value="">â€” Seleccionar â€”</option>
            <option value="site">ğŸŒ Sitio Web</option>
            <option value="redes">ğŸ“± Redes Sociales</option>
            <option value="convite">âœ‰ï¸ Convite Digital</option>
          </select>
        </div>
      </div>
      <div class="fg">
        <label>DescripciÃ³n</label>
        <input type="text" id="prjDesc" placeholder="Breve descripciÃ³n del proyecto"/>
      </div>
      <div class="fg">
        <label>Link del proyecto</label>
        <input type="url" id="prjLink" placeholder="https://..."/>
        <p class="hint">URL para que el visitante pueda ver el proyecto completo</p>
      </div>
      <div class="fg">
        <label>Imagen del proyecto *</label>
        <input type="file" id="prjImage" accept="image/*" required/>
        <p class="hint">Imagen nÃ­tida del proyecto. Recomendado: 1200Ã—800px o mÃ¡s.</p>
        <div id="prjPreviewWrap" style="display:none;margin-top:10px;">
          <img id="prjPreview" style="width:100%;max-height:200px;object-fit:cover;border-radius:8px;border:1px solid #21262d;"/>
        </div>
      </div>
      <!-- Upload progress -->
      <div id="prjProgress" style="display:none;margin-top:8px;">
        <div style="background:#0d1117;border-radius:6px;height:6px;overflow:hidden;margin-bottom:6px;">
          <div id="prjProgressBar" style="height:100%;background:linear-gradient(90deg,#1f6feb,#0ea5e9);width:0%;transition:width .3s;border-radius:6px;"></div>
        </div>
        <p id="prjProgressTxt" style="font-size:.72rem;color:#484f58;">Subiendo imagen...</p>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:14px;">
        <button type="button" class="btn btn-gray" data-close>Cancelar</button>
        <button type="submit" class="btn btn-blue" id="saveProjectBtn">â˜ï¸ Guardar Proyecto</button>
      </div>
    </form>
  </div>
</div>

<script type="module" src="js/admin.js?v=2.0.0"></script>
</body>
</html>
